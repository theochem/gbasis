
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Evaluations: Basis Functions and Electostatic potential &#8212; Ayers Lab</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=87e54e7c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=3ee479438cf8b5e0d341"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'tutorial/Evaluations_basis_and_potential';</script>
    <link rel="icon" href="../_static/favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Evaluations: Electron Density and Related Properties" href="Evaluations_electron_density.html" />
    <link rel="prev" title="GBasis Tutorial - Integrals" href="Tutorial%202%20-%20Integrals.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Ayers Lab - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Ayers Lab - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome to GBasisâ€™s Documentation!
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">User Documentation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Tutorial%201%20-%20Basis%20Sets.html">Tutorial 1: Basis Sets</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tutorial%202%20-%20Integrals.html">Tutorial 2: Integrals</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Evaluations: Basis and Potential</a></li>
<li class="toctree-l1"><a class="reference internal" href="Evaluations_electron_density.html">Evaluations: Electron Density</a></li>
<li class="toctree-l1"><a class="reference internal" href="Evaluations_1rdm_properties.html">Evaluations: 1RDM Properties</a></li>
<li class="toctree-l1"><a class="reference internal" href="JCP_paper.html">JCP Paper examples</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">API</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../_autosummary/gbasis.html">gbasis package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../_autosummary/gbasis.evals.html">gbasis.evals package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_autosummary/gbasis.integrals.html">gbasis.integrals package</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/theochem/gbasis/blob/master/website/tutorial/Evaluations_basis_and_potential.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/theochem/gbasis" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/theochem/gbasis/issues/new?title=Issue%20on%20page%20%2Ftutorial/Evaluations_basis_and_potential.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/tutorial/Evaluations_basis_and_potential.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Evaluations: Basis Functions and Electostatic potential</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-data">Load Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#define-auxiliary-grids">Define Auxiliary Grids</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#obtain-homo-and-lumo">Obtain HOMO and LUMO</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluate-orbitals-in-uniform-grid">Evaluate Orbitals in Uniform Grid</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#export-desired-orbitals-to-cube-files">Export Desired Orbitals to Cube Files</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-homo">Plot HOMO</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluate-electrostatic-potential">Evaluate Electrostatic Potential</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="evaluations-basis-functions-and-electostatic-potential">
<h1>Evaluations: Basis Functions and Electostatic potential<a class="headerlink" href="#evaluations-basis-functions-and-electostatic-potential" title="Link to this heading">#</a></h1>
<p>Other than the electron density <span class="math notranslate nohighlight">\(\rho(\mathbf{r})\)</span>, the one-electron reduced density matrix (1-RDM) <span class="math notranslate nohighlight">\(\gamma(\mathbf{r}, \mathbf{r}')\)</span> and their derived properties, <a class="reference external" href="http://gbasis.qcdevs.org/intro.html"><code class="docutils literal notranslate"><span class="pre">gbasis</span></code></a> supports the evaluation of the basis functions <span class="math notranslate nohighlight">\(\phi_i(\mathbf{r})\)</span> and the electrostatic potential <span class="math notranslate nohighlight">\(v(\mathbf{r})\)</span>. These properties are commonly used in the analysis of electronic structure calculations and are obtainable from other packages (for their supported methods). In this tutorial, we will show how to evaluate these properties using <code class="docutils literal notranslate"><span class="pre">gbasis</span></code> for a set of points in space. We will also take the opportunity to show how to interface <code class="docutils literal notranslate"><span class="pre">gbasis</span></code> with other packages to load the data (<a class="reference external" href="https://iodata.readthedocs.io/en/latest/"><code class="docutils literal notranslate"><span class="pre">iodata</span></code></a>) and to define the grid of points  and export the results as cube files (<a class="reference external" href="https://grid.qcdevs.org/"><code class="docutils literal notranslate"><span class="pre">grid</span></code></a>).</p>
<section id="load-data">
<h2>Load Data<a class="headerlink" href="#load-data" title="Link to this heading">#</a></h2>
<p>To evaluate properties dependent on the system state, we need its wavefunction or an equivalent representation. In <code class="docutils literal notranslate"><span class="pre">gbasis</span></code>, this is done through the <strong>one-electron reduced density matrix</strong> (1-RDM). As a case example, the following code will load this data from a <code class="docutils literal notranslate"><span class="pre">fchk</span></code> file corresponding to a <code class="docutils literal notranslate"><span class="pre">ub3lyp/aug-cc-pvtz</span></code> calculation on ethylene. The file can be <a class="reference internal" href="#"><span class="xref myst">downloaded</span></a> from the data folder of this repository. For simplicity, we will be using the <a class="reference external" href="https://iodata.readthedocs.io/en/latest/"><code class="docutils literal notranslate"><span class="pre">iodata</span></code></a> package to load the data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">iodata</span> <span class="kn">import</span> <span class="n">load_one</span>
<span class="kn">from</span> <span class="nn">gbasis.wrappers</span> <span class="kn">import</span> <span class="n">from_iodata</span>

<span class="c1"># formchk file available from</span>
<span class="c1">#</span>

<span class="c1"># load molecule info and basis from fchk file</span>
<span class="n">mol_data</span> <span class="o">=</span> <span class="n">load_one</span><span class="p">(</span><span class="s2">&quot;ch2o_q_0.fchk&quot;</span><span class="p">)</span>
<span class="n">ao_basis</span> <span class="o">=</span> <span class="n">from_iodata</span><span class="p">(</span><span class="n">mol_data</span><span class="p">)</span>  <span class="c1"># basis definition for the atomic orbitals</span>

<span class="c1"># one electron RDM from fchk file</span>
<span class="n">rdm</span> <span class="o">=</span> <span class="n">mol_data</span><span class="o">.</span><span class="n">one_rdms</span><span class="p">[</span><span class="s2">&quot;scf&quot;</span><span class="p">]</span>

<span class="c1"># atomic coordinates and numbers</span>
<span class="n">atcoords</span> <span class="o">=</span> <span class="n">mol_data</span><span class="o">.</span><span class="n">atcoords</span>
<span class="n">atnums</span> <span class="o">=</span> <span class="n">mol_data</span><span class="o">.</span><span class="n">atnums</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loaded: </span><span class="si">{</span><span class="n">mol_data</span><span class="o">.</span><span class="n">title</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Basis: </span><span class="si">{</span><span class="n">mol_data</span><span class="o">.</span><span class="n">obasis_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Atom numbers: </span><span class="si">{</span><span class="n">mol_data</span><span class="o">.</span><span class="n">atnums</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Atom coordinates:</span><span class="se">\n</span><span class="si">{</span><span class="n">mol_data</span><span class="o">.</span><span class="n">atcoords</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Molecule is planar: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">atcoords</span><span class="p">[:,</span><span class="w"> </span><span class="mi">2</span><span class="p">],</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">atol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of atomic orbitals: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">ao_basis</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;One electron RDM shape: </span><span class="si">{</span><span class="n">rdm</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Loaded: ch2o_q+0 ub3lyp/aug-cc-pvtz opt-stable-freq
Basis: aug-cc-pvtz
Atom numbers: [8 6 1 1]
Atom coordinates:
[[ 2.27823914e+00  4.13899085e-07  3.12033662e-07]
 [ 1.01154892e-02  1.09802629e-07 -6.99333116e-07]
 [-1.09577141e+00  1.77311416e+00  1.42544321e-07]
 [-1.09577166e+00 -1.77311468e+00  2.44755133e-07]]
Molecule is planar: True
Number of atomic orbitals: 46
One electron RDM shape: (138, 138)
</pre></div>
</div>
</div>
</div>
</section>
<section id="define-auxiliary-grids">
<h2>Define Auxiliary Grids<a class="headerlink" href="#define-auxiliary-grids" title="Link to this heading">#</a></h2>
<p>For the next examples two grids will be used:</p>
<ol class="arabic simple">
<li><p>A uniform <code class="docutils literal notranslate"><span class="pre">grid</span></code> spanning a cube containing the molecule (support export to cube files).</p></li>
<li><p>A planar mesh spanning the molecular plane (that will be used to plot the calculated properties in the plane).</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">grid</span> <span class="kn">import</span> <span class="n">UniformGrid</span>
<span class="kn">from</span> <span class="nn">grid</span> <span class="kn">import</span> <span class="n">UniformInteger</span><span class="p">,</span> <span class="n">LinearInfiniteRTransform</span><span class="p">,</span> <span class="n">Tensor1DGrids</span>

<span class="c1"># create a uniform grid for the molecule (interface to cube files)</span>
<span class="n">mol_grid</span> <span class="o">=</span> <span class="n">UniformGrid</span><span class="o">.</span><span class="n">from_molecule</span><span class="p">(</span><span class="n">atnums</span><span class="p">,</span> <span class="n">atcoords</span><span class="p">,</span> <span class="n">spacing</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">extension</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">rotate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># create a planar grid for the molecule</span>
<span class="n">coord_limit</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">plt_pts</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">plt_lmts</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">coord_limit</span><span class="p">,</span> <span class="n">coord_limit</span><span class="p">,</span> <span class="o">-</span><span class="n">coord_limit</span><span class="p">,</span> <span class="n">coord_limit</span><span class="p">]</span>
<span class="n">x_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">coord_limit</span><span class="p">,</span> <span class="n">coord_limit</span><span class="p">,</span> <span class="n">plt_pts</span><span class="p">)</span>
<span class="n">y_vals</span> <span class="o">=</span> <span class="n">x_vals</span>

<span class="c1"># Sample 3D points uniformly in the molecular xy-plane (z=0)</span>
<span class="n">x_vals</span><span class="p">,</span> <span class="n">y_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x_vals</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">)</span>
<span class="n">x_vals</span><span class="p">,</span> <span class="n">y_vals</span> <span class="o">=</span> <span class="n">x_vals</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">y_vals</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">z_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">x_vals</span><span class="p">)</span>
<span class="n">points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x_vals</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">,</span> <span class="n">z_vals</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>  <span class="c1"># gbasis evaluates at 3D points</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of points in the molecule grid: </span><span class="si">{</span><span class="n">mol_grid</span><span class="o">.</span><span class="n">size</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of points in the planar grid: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of points in the molecule grid: 4788
Number of points in the planar grid: 1600
</pre></div>
</div>
</div>
</div>
</section>
<section id="obtain-homo-and-lumo">
<h2>Obtain HOMO and LUMO<a class="headerlink" href="#obtain-homo-and-lumo" title="Link to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">gbasis</span></code> supports the evaluation of the basis functions <span class="math notranslate nohighlight">\(\phi_i(\mathbf{r})\)</span> for a set of points in space. It also supports the application of an arbitrary transformation (defined by a matrix) to the basis functions before their evaluation. This is useful for evaluating any function given its expansion in the given basis set. For example the following code will evaluate the HOMO and LUMO orbitals of formaldehyde. The results will be stored in a cube file for easier interface with any molecular visualizer.</p>
<section id="evaluate-orbitals-in-uniform-grid">
<h3>Evaluate Orbitals in Uniform Grid<a class="headerlink" href="#evaluate-orbitals-in-uniform-grid" title="Link to this heading">#</a></h3>
<p>The following code shows how to evaluate the basis in the uniform grid points. As we desire to evaluate the MOs instead of the basis functions, the argument <code class="docutils literal notranslate"><span class="pre">transform</span></code> is used with the matrix of the basis set expansion coefficients (transforms from AO to MO).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gbasis.evals.eval</span> <span class="kn">import</span> <span class="n">evaluate_basis</span>

<span class="c1"># extract MO coefficients from iodata object</span>
<span class="n">mo_coeffs</span> <span class="o">=</span> <span class="n">mol_data</span><span class="o">.</span><span class="n">mo</span><span class="o">.</span><span class="n">coeffs</span>

<span class="c1"># Compute expected MO values using GBasis</span>
<span class="n">mo_vals</span> <span class="o">=</span> <span class="n">evaluate_basis</span><span class="p">(</span><span class="n">ao_basis</span><span class="p">,</span> <span class="n">mol_grid</span><span class="o">.</span><span class="n">points</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">mo_coeffs</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MO orbital values shape: </span><span class="si">{</span><span class="n">mo_vals</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2"> -&gt; &quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">mo_vals</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> MOs, </span><span class="si">{</span><span class="n">mo_vals</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> points&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MO orbital values shape: (276, 4788) -&gt; 276 MOs, 4788 points
</pre></div>
</div>
</div>
</div>
</section>
<section id="export-desired-orbitals-to-cube-files">
<h3>Export Desired Orbitals to Cube Files<a class="headerlink" href="#export-desired-orbitals-to-cube-files" title="Link to this heading">#</a></h3>
<p>Here, we select the orbitals we want to extract and a cube file is generated with the results. It is important to understand the correlation between the values generated by <code class="docutils literal notranslate"><span class="pre">gbasis</span></code> and the corresponding MOs. For each grid point, the function <code class="docutils literal notranslate"><span class="pre">evaluate_basis</span></code> returns an array of floats, corresponding to the orbitals sorted by increasing energy values from left to right (index 0 corresponds to the first orbital). In the case of an unrestricted calculation, the alpha orbitals are listed first.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Save the HOMO orbital (alpha)</span>
<span class="n">homo_vals</span> <span class="o">=</span> <span class="n">mo_vals</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">mol_data</span><span class="o">.</span><span class="n">nelec</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="p">:]</span>
<span class="n">mol_grid</span><span class="o">.</span><span class="n">generate_cube</span><span class="p">(</span>
    <span class="n">fname</span><span class="o">=</span><span class="s2">&quot;ch2o_homo_alpha.cube&quot;</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="n">homo_vals</span><span class="p">,</span>
    <span class="n">atcoords</span><span class="o">=</span><span class="n">atcoords</span><span class="p">,</span>
    <span class="n">atnums</span><span class="o">=</span><span class="n">atnums</span><span class="p">,</span>
    <span class="n">pseudo_numbers</span><span class="o">=</span><span class="n">mol_data</span><span class="o">.</span><span class="n">atcorenums</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Save the HOMO orbital (beta)</span>
<span class="n">homo_vals</span> <span class="o">=</span> <span class="n">mo_vals</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">mo_vals</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">mol_data</span><span class="o">.</span><span class="n">nelec</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="p">:]</span>
<span class="n">mol_grid</span><span class="o">.</span><span class="n">generate_cube</span><span class="p">(</span>
    <span class="n">fname</span><span class="o">=</span><span class="s2">&quot;ch2o_homo_beta.cube&quot;</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="n">homo_vals</span><span class="p">,</span>
    <span class="n">atcoords</span><span class="o">=</span><span class="n">atcoords</span><span class="p">,</span>
    <span class="n">atnums</span><span class="o">=</span><span class="n">atnums</span><span class="p">,</span>
    <span class="n">pseudo_numbers</span><span class="o">=</span><span class="n">mol_data</span><span class="o">.</span><span class="n">atcorenums</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Save the LUMO orbital (alpha)</span>
<span class="n">lumo_vals</span> <span class="o">=</span> <span class="n">mo_vals</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">mol_data</span><span class="o">.</span><span class="n">nelec</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="p">:]</span>
<span class="n">mol_grid</span><span class="o">.</span><span class="n">generate_cube</span><span class="p">(</span>
    <span class="n">fname</span><span class="o">=</span><span class="s2">&quot;ch2o_lumo_alpha.cube&quot;</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="n">lumo_vals</span><span class="p">,</span>
    <span class="n">atcoords</span><span class="o">=</span><span class="n">atcoords</span><span class="p">,</span>
    <span class="n">atnums</span><span class="o">=</span><span class="n">atnums</span><span class="p">,</span>
    <span class="n">pseudo_numbers</span><span class="o">=</span><span class="n">mol_data</span><span class="o">.</span><span class="n">atcorenums</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Save the LUMO orbital (beta)</span>
<span class="n">lumo_vals</span> <span class="o">=</span> <span class="n">mo_vals</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">mo_vals</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">mol_data</span><span class="o">.</span><span class="n">nelec</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="p">:]</span>
<span class="n">mol_grid</span><span class="o">.</span><span class="n">generate_cube</span><span class="p">(</span>
    <span class="n">fname</span><span class="o">=</span><span class="s2">&quot;ch2o_lumo_beta.cube&quot;</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="n">lumo_vals</span><span class="p">,</span>
    <span class="n">atcoords</span><span class="o">=</span><span class="n">atcoords</span><span class="p">,</span>
    <span class="n">atnums</span><span class="o">=</span><span class="n">atnums</span><span class="p">,</span>
    <span class="n">pseudo_numbers</span><span class="o">=</span><span class="n">mol_data</span><span class="o">.</span><span class="n">atcorenums</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="plot-homo">
<h2>Plot HOMO<a class="headerlink" href="#plot-homo" title="Link to this heading">#</a></h2>
<p>The next code computes the HOMO (alpha) for the grid of points in the molecular plane. A contour plot representation is also generated.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Compute expected MO values using GBasis</span>
<span class="n">mo_vals</span> <span class="o">=</span> <span class="n">evaluate_basis</span><span class="p">(</span><span class="n">ao_basis</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">mo_coeffs</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<span class="n">homo_vals</span> <span class="o">=</span> <span class="n">mo_vals</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">mol_data</span><span class="o">.</span><span class="n">nelec</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="p">:]</span>

<span class="c1"># plot the HOMO</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
<span class="c1"># Plot the electron density as contour plot</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;HOMO Isovalues&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">points</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">plt_pts</span><span class="p">,</span> <span class="n">plt_pts</span><span class="p">)</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">points</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">plt_pts</span><span class="p">,</span> <span class="n">plt_pts</span><span class="p">)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">homo_vals</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">plt_pts</span><span class="p">,</span> <span class="n">plt_pts</span><span class="p">)</span>
<span class="c1"># Add contour plot of the electron density</span>
<span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">])</span>
<span class="n">cs</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">levels</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
<span class="c1"># Add atomic symbols to the plots</span>
<span class="n">symbols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;O&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">]</span>
<span class="n">xy_coords</span> <span class="o">=</span> <span class="n">atcoords</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="k">for</span> <span class="n">coord</span><span class="p">,</span> <span class="n">symbol</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">xy_coords</span><span class="p">,</span> <span class="n">symbols</span><span class="p">):</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
        <span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
        <span class="n">symbol</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span>
        <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
        <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
        <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">,</span>
    <span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>  <span class="c1"># Adjust layout for better spacing</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/0bb66d4ebfd90bc470f346d894f738d3e3200ce656e1466910dd19cf71d913c2.png" src="../_images/0bb66d4ebfd90bc470f346d894f738d3e3200ce656e1466910dd19cf71d913c2.png" />
</div>
</div>
</section>
<section id="evaluate-electrostatic-potential">
<h2>Evaluate Electrostatic Potential<a class="headerlink" href="#evaluate-electrostatic-potential" title="Link to this heading">#</a></h2>
<p>The following example shows how to evaluate the electrostatic potential of formaldehyde. In this example, the same grids will be used.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gbasis.evals.electrostatic_potential</span> <span class="kn">import</span> <span class="n">electrostatic_potential</span>

<span class="c1"># Compute electrostatic potential at grid points</span>
<span class="n">v_elect</span> <span class="o">=</span> <span class="n">electrostatic_potential</span><span class="p">(</span>
    <span class="n">basis</span><span class="o">=</span><span class="n">ao_basis</span><span class="p">,</span>
    <span class="n">one_density_matrix</span><span class="o">=</span><span class="n">rdm</span><span class="p">,</span>
    <span class="n">points</span><span class="o">=</span><span class="n">mol_grid</span><span class="o">.</span><span class="n">points</span><span class="p">,</span>
    <span class="n">nuclear_coords</span><span class="o">=</span><span class="n">atcoords</span><span class="p">,</span>
    <span class="n">nuclear_charges</span><span class="o">=</span><span class="n">mol_data</span><span class="o">.</span><span class="n">atcorenums</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">mol_grid</span><span class="o">.</span><span class="n">generate_cube</span><span class="p">(</span>
    <span class="n">fname</span><span class="o">=</span><span class="s2">&quot;ch2o_pot.cube&quot;</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="n">v_elect</span><span class="p">,</span>
    <span class="n">atcoords</span><span class="o">=</span><span class="n">atcoords</span><span class="p">,</span>
    <span class="n">atnums</span><span class="o">=</span><span class="n">atnums</span><span class="p">,</span>
    <span class="n">pseudo_numbers</span><span class="o">=</span><span class="n">mol_data</span><span class="o">.</span><span class="n">atcorenums</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The following code computes the electrostatic potential for the grid of points in the molecular plane. A heatmap representation is generated for visualization.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">v_elect_xy</span> <span class="o">=</span> <span class="n">electrostatic_potential</span><span class="p">(</span>
    <span class="n">basis</span><span class="o">=</span><span class="n">ao_basis</span><span class="p">,</span>
    <span class="n">one_density_matrix</span><span class="o">=</span><span class="n">rdm</span><span class="p">,</span>
    <span class="n">points</span><span class="o">=</span><span class="n">points</span><span class="p">,</span>
    <span class="n">nuclear_coords</span><span class="o">=</span><span class="n">atcoords</span><span class="p">,</span>
    <span class="n">nuclear_charges</span><span class="o">=</span><span class="n">mol_data</span><span class="o">.</span><span class="n">atcorenums</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># plot the electron density</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
<span class="c1"># Plot the electron density as contour plot</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Electrostatic Potential&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">points</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">plt_pts</span><span class="p">,</span> <span class="n">plt_pts</span><span class="p">)</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">points</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">plt_pts</span><span class="p">,</span> <span class="n">plt_pts</span><span class="p">)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">v_elect_xy</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">plt_pts</span><span class="p">,</span> <span class="n">plt_pts</span><span class="p">)</span>
<span class="c1"># Add contour plot of the electron density</span>
<span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;viridis&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>

<span class="c1"># Add atomic symbols to the plots</span>
<span class="n">symbols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;O&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">]</span>
<span class="n">xy_coords</span> <span class="o">=</span> <span class="n">atcoords</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="k">for</span> <span class="n">coord</span><span class="p">,</span> <span class="n">symbol</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">xy_coords</span><span class="p">,</span> <span class="n">symbols</span><span class="p">):</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
        <span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
        <span class="n">symbol</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span>
        <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
        <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
        <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">,</span>
    <span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>  <span class="c1"># Adjust layout for better spacing</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/a720c9111b9506f39da05aba89557089efd71d47ff9ccb4764b4105d65b3edeb.png" src="../_images/a720c9111b9506f39da05aba89557089efd71d47ff9ccb4764b4105d65b3edeb.png" />
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "theochem/gbasis",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./tutorial"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Tutorial%202%20-%20Integrals.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">GBasis Tutorial - Integrals</p>
      </div>
    </a>
    <a class="right-next"
       href="Evaluations_electron_density.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Evaluations: Electron Density and Related Properties</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-data">Load Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#define-auxiliary-grids">Define Auxiliary Grids</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#obtain-homo-and-lumo">Obtain HOMO and LUMO</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluate-orbitals-in-uniform-grid">Evaluate Orbitals in Uniform Grid</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#export-desired-orbitals-to-cube-files">Export Desired Orbitals to Cube Files</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-homo">Plot HOMO</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluate-electrostatic-potential">Evaluate Electrostatic Potential</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The QC-Dev Community with the support of Digital Research Alliance of Canada and The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      Â© Copyright 2022-2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>